# 寄存器

有名寄存器 a-z

常用寄存器：

- 复制专用寄存器 `"0` 使用 y 复制文本的同时会被拷贝到复制寄存器 0
- 系统剪贴板 `"+` 可以在复制前加上 `"+` 复制到系统剪贴板，或直接使用 `:set clipboard=unnamed` 将无名寄存器的内容绑定到系统剪贴板
- 其他一些寄存器，比如 `"%` 当前文件名，`".` 上次插入的文本
- 搜索寄存器 `"/`
- 0-9 clipboard register，黏贴寄存器，通常由 `dd` 添加历史中，可以在使用过 `"1p` 后通过 `.` 来快速 undo，`y` 不会添加到粘贴板历史中

Vim 不使用单一剪贴板进行剪贴、复制与黏贴，而是多组寄存器

- 通过 `"{registerName}` 前缀可以指定寄存器，**不指定默认用无名寄存器**
- 例如 `"ayiw` 复制一个单词到寄存器 a 中，`"bdd` 剪切当前行到寄存器b 中
- 又或是 `"/p` 将正在搜索的内搜索寄存器黏贴出来
- 当不想覆盖上一次复制的内容时，可以使用 _Blackhole registers_ `""dd` 通过 `"1p` 来粘贴 `""dd` 的内容
- `:registers` 查看所有寄存器的内容

# 标记

`m<id>` id: a-zA-z

| '<id>      | 返回标记行首                                 |
| ---------- | -------------------------------------------- |
| `<id>      | 返回标记时所处行、列                         |
| ['         | 跳转到上一处标记点跳转到上一处标记点         |
| ]'         | 跳转到下一处标记点                           |
| [`         | 跳转到上一处标记点当时所处行列               |
| ]`         | 跳转到下一处标记点当时所处行列               |
| dm<id>     | 删除标记                                     |
| :marks     | 显示所有标记                                 |
| `.         | 跳转到当前 buffer 中上一次修改的地方 类似 gi |
| `"         | 跳转到上一次编辑过的文件                     |
| `0         | 跳转到上一次编辑过的文件                     |
| `1         | 类似 \`0 但是是上一个文件(以及 \`2 等等)     |
| ''         | 跳转到上一次跳转到地方的行首                 |
| ``         | 跳转到上一次跳转到的地方的行列处             |
| \`[ 或 \`] | 跳转到上一次修改或粘贴处的行首或行尾         |
| \`< 或 \`> | 跳转到上一次 visual 模式选择处的行首或行尾   |

# Buffer

一个 tab 中可以有很多的窗口，而不同的窗口却可以打开相同的文件，此时 vim 会将文件内容读取到内存中，这些窗口显示的内容则为该文件在内存中的引用，也就是 buffer，简单来说打开同一文件则会拥有相同的 buffer

# 小 Tps

命令模式下（`:`）输出 `<c-r> + <c-w>` 可以将光标所在处的单词复制粘贴到命令行中, `<c-r>*` 可以将粘贴板中的内容粘贴到命令行中

在 `insert mode` 下可以通过先按下 <kbd>\<C-o\></kbd> 快速进入 `normal mode`

打开光标所在文件路径的文件 `gf`

打开光标所在文件路径的URL `gx`

搜索前通过切换 `<cmd>set ignorecase<cr>` 和 `<cmd>set noignorecase<cr>` 提高搜索体验

删除匹配的行: `<cmd>g/{pattern}/d<cr>`, 删除不匹配的行: `<cmd>g!/{pattern}/d<cr>`

替换的内容需要保留原本字符的大小写时,使用 `S`: `:%S/pattern/replacement/g`(neovim 貌似不支持)

insert mode:

- `<c-t>` 缩进当前行
- `<c-d>` 反向缩进当前行

searching mode:

- `<c-t>` 跳转到上一个且不退出搜索
- `<c-g>` 跳转到下一个且不退出搜索

正则:

- `\{number}` 表示匹配的组, `s/string_\(\w*\)/\1/`
- `&` 表示匹配的字符, `s/string_pattern/&/`

sort:

- `sort` 将所有行排序
- `sort!` 将所有行逆序排序
- `sort u` 将所有行去重并排序
- `sort i` 将忽略所有行大小写排序
- `sort n` 将所有按数字顺序排序

# 命令

- `set nocompatible` 设置只在当前项目进行搜索（放在配置最前面）

- `syntax on` 设置语法高亮，vim 大部分情况下都能识别文件类型进行语法高亮

- `set tabstop=2` 设置 tab 键的宽度

- `set autoindent` 开启 自动锁进

- `set encoding=utf8` 设置输入格式为 utf8

- `set path+=**` 可以递归搜索当前文件下所有的文件（:find 查找文件）

- `set wildmenu` 命令模式输入命令时，按 Tab 进行补全后会显示可选择的文件

- `set textwidth=` 设置一行显示的最大宽度

- `set fo=Mm` 字段换行在中文下生效

- `set foldmethod` 开启折叠功能(manual marker indent syntax expr diff)
  - `zf` visual 模式选中文字后创建折叠
  - `zo` 打开折叠块
  - `zc` 折叠折叠快
  - `za` 切换折叠、打开折叠块
  - `zM` 折叠所有折叠块
  - `zR` 打开所有折叠块
  - `zd` 删除折叠块
  - `zD` 递归删除折叠块

# 插入

| 操作 |          描述          |
| :--: | :--------------------: |
|  i   | 插入在光标所在位置之前 |
|  a   | 插入在光标所在位置之后 |
|  I   |     插入在当前行首     |
|  A   |     插入在当前行尾     |
|  o   |      插入在下一行      |
|  O   |      插入在上一行      |

# 移动

|       操作        |              描述              |
| :---------------: | :----------------------------: |
|         w         |       跳到下一个单词开头       |
|         e         |   跳到本单词或下一个单词结尾   |
|         b         |   跳到本单词或上一个单词开头   |
|        ge         |       跳到上一个单词结尾       |
|         0         |          跳到当前行首          |
|         $         |          跳到当前行尾          |
|         ^         |  跳到当前行首第一个非空的位置  |
|        gg         |           跳到第一行           |
|         G         |          跳到最后一行          |
|         %         |     在闭合的 \(\) 之间移动     |
|        \{         |         移动至上一段落         |
|        \}         |         移动至下一段落         |
|     f\{char\}     |     跳到下一个指定字符位置     |
|     F\{char\}     |     跳到上一个指定字符位置     |
|     t\{char\}     | 跳到下一个指定字符的后一个位置 |
|     T\{char\}     | 跳到上一个指定字符的后一个位置 |
|         ;         |         重复上一次查找         |
|         ,         |      反向查找上次查找动作      |
| [n]gg\/[n]G\/:[n] |         跳转到第 n 行          |
|        gi         |     跳转到上一次插入的位置     |
|       <C-b>       |       插入模式下向前移动       |
|       <C-f>       |       插入模式下向后移动       |
|       <C-p>       |       插入模式下向上移动       |
|       <C-n>       |       插入模式下向下移动       |
|       <C-d>       |            向下翻页            |
|       <C-u>       |            向上翻页            |
|       <C-y>       |          向下移动屏幕          |
|       <C-e>       |          向上移动屏幕          |

# 定位光标

| 操作 |             描述             |
| :--: | :--------------------------: |
|  zz  |   让光标所在的行居屏幕中央   |
|  zt  | 让光标所在的行居屏幕最上一行 |
|  zb  | 让光标所在的行居屏幕最下一行 |

# 查找

|          操作          |                    描述                    |
| :--------------------: | :----------------------------------------: |
| /\{char\} \| g\*{char} | （模糊）全文查找 char，n\(next\)/N\(prev\) |
|  ?{char} \| g#{char}   |  （模糊）全文查找 char，n\(prev)/N\(next)  |
|        \*{char}        | （精确）全文查找 char，n\(next\)/N\(prev)  |
|        #{char}         | （精确）全文查找 char，n\(next\)/N\(prev)  |
|    /\v{expression}     |                  正则匹配                  |

# 批量操作

|                 操作                 |                 描述                 |
| :----------------------------------: | :----------------------------------: |
| :/\{range\}s/\{target\}/\{result\}/g | 将 range 行中的 target 替换为 result |
|                <C-v>                 |      选择完成后按 I/A 进入编辑       |

# 选择（需与操作符联用）

|         操作         |           描述            |
| :------------------: | :-----------------------: |
|       iw / aw        |  选择单词/选择单词及周围  |
| i\( / a\( 或 ib / ab | 选择\(内/选择\(内及\(本身 |
| i\{ / a\{ 或 iB / aB | 选择\{内/选择\{内及\{本身 |
|       i" / a"        |  选择"内/选择"内及"本身   |
|       i' / a'        |  选择'内/选择'内及'本身   |
|       i< / a<        |  选择<内/选择<内及<本身   |
|       i[ / a[        |  选择[内/选择[内及[本身   |
|       it / at        |           标签            |
|       is / as        |           句子            |
|       ip / ap        |        段落操作符         |
|       ie / ae        |         整个内容          |
|          v           |       选中当前字符        |
|          V           |        选中当前行         |
|        <C-v>         |           多选            |

# 操作符

|      操作       |                       描述                        |
| :-------------: | :-----------------------------------------------: |
|        x        |                 将所选的字符剪切                  |
|       d0        |               从当前位置剪切到开头                |
|       d^        |         从当前位置剪切到开头第一个非空处          |
|       d$        |               从当前位置剪切到行尾                |
|       die       |                   剪切整个内容                    |
|       dit       |             剪切当前标签内的所有内容              |
|   df\{char\}    |        从当前位置剪切到第一个 char 的位置         |
|       dd        |                     剪切整行                      |
|      [n]dd      |                   向下剪切 n 行                   |
|        r        |          将所选的字符替换为新输入的字符           |
|        c        |              删除所选并进入插入模式               |
|       c0        |        从当前位置删除到开头并进入插入模式         |
|       c^        |  从当前位置删除到开头第一个非空处并进入插入模式   |
|       c$        |        从当前位置删除到行尾并进入插入模式         |
|       cie       |            删除整个内容并进入插入模式             |
|       cit       |      删除当前标签内的所有内容并进入插入模式       |
|   cf\{char\}    | 从当前位置删除到第一个 char 的位置并进入插入模式  |
|       cc        |              删除整行并进入插入模式               |
|      [n]cc      |            向下删除 n 行并进入插入模式            |
|        y        |                     复制所选                      |
|       yie       |                   复制整个内容                    |
|       yy        |                     复制整行                      |
|        p        |                       粘贴                        |
|        u        |           撤销上一次 insert 模式的内容            |
|        v        |                 进入 VISUAL 模式                  |
|      &lt;       |                     向左缩进                      |
|      &gt;       |                     向右缩进                      |
|        .        |                   重复之前的命                    |
|  选择内容后 gc  |               注释所选内容所在的行                |
|       gcc       |                    注释当前行                     |
|    gc{j, k}     |                    向下/上注释                    |
| [count] \<C-x\> | 自动向后找寻当前行第一个数字/将光标所在的数字减一 |
| [count] \<C-a\> | 自动向后找寻当前行第一个数字/将光标所在的数字加一 |

# 修改成对的符号

|        操作         |                               描述                                |
| :-----------------: | :---------------------------------------------------------------: |
|  cs\{old\}\{new\}   | 将包围光标所在处的成对符号，例如 "content" 改为 char content char |
| ys\{count\}\{char\} |                 将 count 范围内的内容用 char 包裹                 |
|       ysaptli       |                     将整个段落用 li 标签 包裹                     |
|     ds\{char\}      |                   将光标所在单词的成对符号剪切                    |
|      S\{char\}      |                    将光标所选内容用 char 包裹                     |

# 大小写转换

|        操作         |                  描述                   |
| :-----------------: | :-------------------------------------: |
|       ~ / v~        |        将光标下的字母改变大小写         |
|         3~          | 将光标位置开始向后的 3 个字母改变大小写 |
|         g~          |         改变当前行字母的大小写          |
|         vu          |           将所选字母变为小写            |
|         vU          |           将所选字母变为大写            |
|      gUU / VU       |         将当前行的字母改成大写          |
|      guu / Vu       |         将当前行的字母改成小写          |
| gUaw\(gUiw\) / viwU |         将光标下的单词改成大写          |
| guaw\(guiw\) / viwu |         将光标下的单词改成小写          |

# 折叠、展开代码块

| 操作 |           描述           |
| :--: | :----------------------: |
|  zc  |        折叠代码块        |
|  zo  |        展开代码块        |
|  za  | 切换代码块折叠、展开状态 |

# 单词拼写操作

|            操作            |              描述              |
| :------------------------: | :----------------------------: |
| :set spell seplllang=en_us |        设置拼写检查语言        |
|         :spelldump         |          开启拼写检查          |
|        :set nospell        |          关闭拼写检查          |
|             ]s             | 光标定位到下一处单词错误的位置 |
|             [s             | 光标定位到上一处单词错误的位置 |
|             zg             | 将当前单词添加到个人单词列表中 |
|             zw             | 将当前单词从个人单词列表中移除 |
|             z=             |      选择修改后的目标单词      |
|         <i> <C-x>s         |      选择修改后的目标单词      |

# 功能操作

| 操作  |                描述                |
| :---: | :--------------------------------: |
|  gd   |    go definition 跳转到函数定义    |
|  gh   |         go hover 显示提示          |
|  tn   |   go tag next 跳转到下一个标签页   |
|  tp   | go tag previous 跳转到上一个标签页 |
| [n]gt |        跳转到第 n 个标签页         |
| <C-6> |     切换当前文件与上一次的文件     |

# 标签页操作

| 操作  |        描述        |
| :---: | :----------------: |
| :tabc |   关闭当前标签页   |
| :tabc |   关闭当前标签页   |
| :tabo | 关闭所有其他的 tab |
| :tabs | 查看所有打开的 tab |
| :tabp |       前一个       |
| :tabn |       后一个       |
